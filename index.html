<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <title>Screenio</title>
  <meta name="description" content="Here to help you get a feel for the relative size and resolution of displays.">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="theme-color" content="#fafafa">

  <style>
    body {
      min-height: 100vh;
      margin: 0;
      font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
      /* background-color: #F3F6F9; */
    }

    h1 {
      text-align: center;
      margin: 3rem 1rem 1rem;
      font-size: 3.5rem;
      font-weight: 500;
    }

    .description {
      margin: 1rem 1rem 4rem 1rem;
      text-align: center;
      font-size: 1.25rem;
      color: #383838;
      font-weight: 300;
    }

    .display-selectors {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }

    .display-selector {
      margin: 0 1rem 1rem 1rem;
      display: flex;
      align-items: center;
      background: white;
      border: 1px solid #d2d2d7;
      border-radius: 1rem;
    }

    .display-selector:before {
      content: '';
      display: inline-block;
      border-radius: 0.75rem;
      margin-left: 0.5rem;
      vertical-align: bottom;
      border: 1rem solid;
    }

    .display-selector .title {
      color: #383838;
      padding: 0 0.5rem;
    }

    .display-selector label {
      color: #383838;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .display-selector span {
      position: absolute;
      top: 0.25rem;
      left: 0.5rem;
      font-size: 0.8rem;
    }

    .display-selector input,
    .display-selector select {
      font-size: 16px;
      padding: 1.25rem 0.5rem 0.5rem 0.5rem;
      border: solid #d2d2d7 0;
      border-left-width: 1px;
      background: none;
      border-radius: 0;
    }

    .display-selector input {
      max-width: 4rem;
    }

    #explanation {
      font-size: 1.5rem;
      color: #929292;
      font-weight: 300;
      margin: 4rem 2rem;
    }

    a {
      text-decoration: none;
      color: #929292;
      font-weight: 300;
      padding: 1.5rem;
    }
  </style>
  
  <script defer data-domain="screenio.rosengren.me" src="https://plausible.io/js/plausible.js"></script>
</head>

<body>
  <h1>Screenio</h1>
  <div class="description">Here to help you get a feel for the relative size and resolution of displays.</div>
  <div class="display-selectors">
    <div class="display-selector-js display-selector" style="color: #FF6E40" data-secondary-color="#DD2C00">
      <div class="title">Display 1</div>
      <label>
        <span>Size (inch)</span>
        <input type="number" step="0.5" value="32">
      </label>
      <label>
        <span>Resolution</span>
        <select>
          <option value="6016x3384">6016x3384px</option>
          <option value="5120x2880">5120x2880px</option>
          <option value="5120x1440">5120x1440px</option>
          <option value="3840x2160">3840x2160px</option>
          <option value="3440x1440">3440x1440px</option>
          <option value="2560x1600">2560x1600px</option>
          <option value="2560x1440" selected>2560x1440px</option>
          <option value="2560x1080">2560x1080px</option>
          <option value="1920x1200">1920x1200px</option>
          <option value="1920x1080">1920x1080px</option>
          <option value="1280x1024">1280x1024px</option>
          <option value="1024x768">1024x768px</option>
        </select>
      </label>
    </div>
    <div class="display-selector-js display-selector" style="color: #0091EA" data-secondary-color="#4FC3F7">
      <div class="title">Display 2</div>
      <label>
        <span>Size (inch)</span>
        <input type="number" step="0.5" value="24">
      </label>
      <label>
        <span>Resolution</span>
        <select>
          <option value="6016x3384">6016x3384px</option>
          <option value="5120x2880">5120x2880px</option>
          <option value="5120x1440">5120x1440px</option>
          <option value="3840x2160">3840x2160px</option>
          <option value="3440x1440">3440x1440px</option>
          <option value="2560x1600">2560x1600px</option>
          <option value="2560x1440">2560x1440px</option>
          <option value="2560x1080">2560x1080px</option>
          <option value="1920x1200">1920x1200px</option>
          <option value="1920x1080" selected>1920x1080px</option>
          <option value="1280x1024">1280x1024px</option>
          <option value="1024x768">1024x768px</option>
        </select>
      </label>
    </div>
  </div>
  <div style="position:relative;padding: 1rem; text-align: center;">
    <div style="position: relative;text-align: center; z-index:2">
      <svg id="render" style="margin: 2rem; max-height: 80vh; margin: auto"></svg>
    </div>
    <div style="position: relative;text-align: center;margin-top: -10%;z-index: 1">
      <svg width="30%" viewBox="0 0 166.29921 116.20424">
        <path
          d="M 113.6995,4.9257854e-7 H 48.811238 A 3.4621428,3.4574567 0 0 0 45.354333,3.4611304 V 105.82677 H 117.16536 V 3.4611304 A 3.4640119,3.4593232 0 0 0 113.6995,4.9257854e-7 Z M 81.473684,58.1629 A 7.6981952,7.6877754 0 0 1 73.811442,50.511078 V 38.70409 a 7.6622224,7.6518513 0 0 1 15.324435,0 V 50.511078 A 7.6980753,7.6876556 0 0 1 81.473684,58.1629 Z"
          fill="#2f2e41" id="path9" style="stroke-width:0.998845" />
        <path
          d="m 44.694686,102.74061 v 9.89437 a 1.93826,1.93826 0 0 0 1.93434,1.93428 h 68.422464 a 1.944,1.944 0 0 0 1.93428,-1.93428 v -9.89437 z"
          fill="#3f3d56" id="path11" />
        <path
          d="M 163.34862,116.20425 H 2.9506301 a 2.9506238,2.9864 0 0 1 -2.887351,-3.60157 L 2.5521023,100.63882 A 2.9633594,2.99929 0 0 1 5.438979,98.267717 H 160.86024 a 2.9633693,2.9993 0 0 1 2.88687,2.371103 l 2.48883,11.96386 a 2.9506337,2.98641 0 0 1 -2.88736,3.60157 z"
          fill="#2f2e41" id="path13" style="stroke-width:0.993992" />
        <rect x="6" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect15" />
        <rect x="16" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect17" />
        <rect x="26" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect19" />
        <rect x="36" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect21" />
        <rect x="46" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect23" />
        <rect x="56" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect25" />
        <rect x="66" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect27" />
        <rect x="76" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect29" />
        <rect x="86" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect31" />
        <rect x="96" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect33" />
        <rect x="106" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect35" />
        <rect x="116" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect37" />
        <rect x="126" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect39" />
        <rect x="136" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect41" />
        <rect x="146" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect43" />
        <rect x="156" y="101" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect45" />
        <rect x="6" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect47" />
        <rect x="16" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect49" />
        <rect x="26" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect51" />
        <rect x="36" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect53" />
        <rect x="46" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect55" />
        <rect x="56" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect57" />
        <rect x="66" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect59" />
        <rect x="76" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect61" />
        <rect x="86" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect63" />
        <rect x="96" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect65" />
        <rect x="106" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect67" />
        <rect x="116" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect69" />
        <rect x="126" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect71" />
        <rect x="136" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect73" />
        <rect x="146" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect75" />
        <rect x="156" y="106" width="5" height="3" rx="0.48819" fill="#3f3d56" id="rect77" />
        <rect x="54" y="112" width="40" height="3" rx="0.48819" fill="#3f3d56" id="rect79" />
      </svg>
    </div>
    <p id="explanation"></p>
    <a href="https://rosengren.me">Check out my other stuff @ https://rosengren.me</a>
  </div>
  <script>

    const physicalScale = 100;
    const chromeRadius = 25;

    /*
     * Calculates the PPI and scaled size of a size:resolution combo.
     */
    function getDisplayScaleProperties(input) {
      const resolutionPxHypothenuse = Math.sqrt(Math.pow(input.resolutionPx.height, 2) + Math.pow(input.resolutionPx.width, 2));
      const ppi = resolutionPxHypothenuse / input.physicalIn.hypothenuse;
      const width = Math.round(input.resolutionPx.width / ppi * physicalScale);
      const height = Math.round(input.resolutionPx.height / ppi * physicalScale);
      return {
        ppi,
        scaledPx: {
          width,
          height,
          area: width * height
        }
      }
    }

    function getDisplayFromGroup(g) {
      const resolution = g.querySelector('select').value;
      const width = resolution.substring(0, resolution.indexOf('x'));
      const height = resolution.substring(resolution.indexOf('x') + 1);
      return {
        color: {
          primary: g.style.color,
          secondary: g.getAttribute('data-secondary-color')
        },
        physicalIn: {
          hypothenuse: g.querySelector('input[type="number"]').value
        },
        resolutionPx: {
          width,
          height,
          area: width * height
        }
      };
    }

    function getRenderSize(displays) {
      return {
        width: Math.max(...displays.map(x => x.scaledPx.width)),
        height: Math.max(...displays.map(x => x.scaledPx.height))
      }
    }

    function getRelativeObjectResolutionSizeSize(displays) {
      const leastResolutionHeight = Math.min(...displays.map(x => x.resolutionPx.height));
      // Assume that a displays width is always greater than its height
      return {
        height: leastResolutionHeight / 3
      };
    }

    function renderDisplay(display, renderSize) {
      const g = document.createElementNS('http://www.w3.org/2000/svg', "g");
      g.setAttribute('fill', display.color.primary);

      const chrome = document.createElementNS('http://www.w3.org/2000/svg', "path");
      const h = display.scaledPx.height;
      const w = display.scaledPx.width;
      const r = chromeRadius;
      // originX gets an extra "+ r" as we need to make room for the closing q.
      const originX = ((renderSize.width - display.scaledPx.width) / 2) + r;
      const originY = ((renderSize.height - display.scaledPx.height) / 2);
      chrome.setAttribute('d', `
      M${originX} ${originY}
      l ${w} 0
      q ${r},0 ${r},${r}
      l0 ${h}
      q 0,${r} -${r},${r}
      l-${w} 0
      q -${r},0 -${r},-${r}
      l0 -${h}
      q0,-${r} ${r},-${r}`);
      chrome.style = 'opacity: 1; fill: #3f3d56';

      const rect = document.createElementNS('http://www.w3.org/2000/svg', "rect");
      rect.setAttribute('width', display.scaledPx.width);
      rect.setAttribute('height', display.scaledPx.height);
      rect.setAttribute('x', ((renderSize.width - display.scaledPx.width) / 2) + r);
      rect.setAttribute('y', ((renderSize.height - display.scaledPx.height) / 2) + r);
      // rect.style = 'opacity: 0.5';


      g.appendChild(chrome);
      g.appendChild(rect);

      return g;
    }

    function renderRelativeObject(displayRelativeObjectSize, color) {
      const relativeObject = document.createElementNS('http://www.w3.org/2000/svg', "text");
      relativeObject.innerHTML = 'A';
      relativeObject.setAttribute('x', '50%');
      relativeObject.setAttribute('y', '50%');
      relativeObject.setAttribute('dominant-baseline', 'middle');
      relativeObject.setAttribute('text-anchor', 'middle');
      relativeObject.style = `fill: ${color}; font-size: ${displayRelativeObjectSize}px`;

      return relativeObject;
    }

    function renderDisplays(displaySelectGroups, svg, output) {
      // Calculate the properties for the listed displays
      const displaysByPhysicalArea = displaySelectGroups
        .map(g => getDisplayFromGroup(g))
        .map((x, i) => ({
          name: i + 1,
          ...getDisplayScaleProperties(x),
          ...x
        }))
        // It might be better to sort based on height,
        // initial thought is that it might feel better in the case of ultrawides (which is often sent to the back with the current sort)
        .sort((a, b) => b.scaledPx.area - a.scaledPx.area);

      // Set the render size of the svg
      const renderSize = getRenderSize(displaysByPhysicalArea);
      const unScaledRelativeObjectSize = getRelativeObjectResolutionSizeSize(displaysByPhysicalArea);

      // Clear the render svg
      svg.innerHTML = '';
      svg.setAttribute('viewBox', `0 0 ${renderSize.width + (2 * chromeRadius)} ${renderSize.height + (2 * chromeRadius)}`);

      displaysByPhysicalArea.forEach((display, i) => {
        svg.appendChild(renderDisplay(display, renderSize));
      });

      const displaysByRelativeSize = displaysByPhysicalArea.map((x, i) => ({
        ppi: x.ppi,
        color: x.color.secondary,
        scaledRelativeObjectSize: unScaledRelativeObjectSize.height / x.ppi * physicalScale
      }))
        .sort((a, b) => b.scaledRelativeObjectSize - a.scaledRelativeObjectSize);

      displaysByRelativeSize.forEach(display => {
        svg.appendChild(renderRelativeObject(display.scaledRelativeObjectSize, display.color));
      });

      // TODO: Verify the differences as we're always calculating from higher > lower, but text mentions smaller/larger
      const relativeDifference = Math.round(displaysByRelativeSize[0].scaledRelativeObjectSize / displaysByRelativeSize[1].scaledRelativeObjectSize * 100 - 100);
      const physicalDifference = Math.round(displaysByPhysicalArea[0].scaledPx.area / displaysByPhysicalArea[1].scaledPx.area * 100 - 100);
      const resolutionDifference = Math.round(displaysByPhysicalArea[0].resolutionPx.area / displaysByPhysicalArea[1].resolutionPx.area * 100 - 100);

      const d1 = capitalize => `<span style="color: ${displaysByPhysicalArea[0].color.primary}">${capitalize ? 'D' : 'd'}isplay ${displaysByPhysicalArea[0].name}</span>`;
      const d2 = capitalize => `<span style="color: ${displaysByPhysicalArea[1].color.primary}">${capitalize ? 'D' : 'd'}isplay ${displaysByPhysicalArea[1].name}</span>`;

      let ex = '';
      if (physicalDifference == 0 && resolutionDifference == 0) ex = 'These displays are of equal size and has the same resolution area.';
      else if (physicalDifference == 0 && resolutionDifference > 0) ex = `${d1(true)} will fit ${resolutionDifference}% more content than ${d2(false)}, but objects will appear ${relativeDifference}% smaller, even though the displays are the same physical size.`;
      else if (physicalDifference == 0 && resolutionDifference < 0) ex = `${d1(true)} will fit ${Math.abs(resolutionDifference)}% less content than ${d2(false)} , and objects will appear ${relativeDifference}% larger, even though the displays are the same physical size.`;
      else if (physicalDifference > 0 && resolutionDifference == 0) ex = `${d1(true)} will fit the same amount of content as ${d2(false)}, but objects will be ${relativeDifference}% larger due to ${d1(false)}'s ${physicalDifference}% larger physical size.`;
      else if (physicalDifference > 0 && resolutionDifference > 0 && relativeDifference == 0) ex = `${d1(true)} will fit ${resolutionDifference}% more content than ${d2(false)}, but objects will have the same size due to ${d1(false)}'s ${physicalDifference}% larger physical size.`;
      else if (physicalDifference > 0 && resolutionDifference > 0 && relativeDifference > 0) ex = `${d1(true)} is ${physicalDifference}% larger than ${d2(false)}, and will fit ${resolutionDifference}% more content, but objects will appear smaller due to ${d1(false)}'s higher ppi.`;
      else if (physicalDifference > 0 && resolutionDifference > 0 && relativeDifference < 0) ex = `${d1(true)} is ${physicalDifference}% larger than ${d2(false)} and will fit ${resolutionDifference}% more content, but objects will appear ${Math.abs(relativeDifference)}% bigger due to display x's lower ppi.`;
      else if (physicalDifference > 0 && resolutionDifference < 0) ex = `${d1(true)} is ${physicalDifference}% larger than ${d2(false)}, but will fit ${Math.abs(resolutionDifference)}% less content. Objects will appear larger on ${d1(false)} than on ${d2(false)} due to ${d1(false)}'s lower ppi.`;

      document.getElementById('explanation').innerHTML = `"${ex}"`;
    }

    const selectorGroups = Array.from(document.getElementsByClassName('display-selector-js'));

    const output = document.getElementById('output');
    const svg = document.getElementById('render');

    renderDisplays(selectorGroups, svg, output);

    selectorGroups
      .forEach(g => {
        g.querySelector('input[type="number"]')
          .addEventListener('input', e => {
            renderDisplays(selectorGroups, svg, output);
          });
        g.querySelector('select')
          .addEventListener('input', () => renderDisplays(selectorGroups, svg, output));
      });

  </script>
</body>

</html>
